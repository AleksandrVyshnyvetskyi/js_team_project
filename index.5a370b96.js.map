{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,2FAOMC,EAAa,IAAI,EAAAC,EAAAC,SACjBC,EAAa,IAAI,EAAAC,EAAAF,S,SAoBRG,I,OAAAC,EAAcC,MAAAC,KAAAC,U,UAAdH,I,OAAAA,EAAfI,EAAAZ,EAAA,CAAAY,EAAAC,GAAAC,MAAA,SAAAC,I,IAA8BC,EAEpBC,EAASC,EAAAP,U,yEAFWK,EAAAE,EAAAC,OAAA,YAAAD,EAAA,IAAYA,EAAA,GAEhCD,EAAYD,GAAc,EACJd,EAAjBkB,cAAgBH,E,kBAGYf,EAAlBmB,mBAAmBC,MAAK,SAAAC,GACvC,GAAyB,IAArBA,EAAKC,YACN,OAAOC,EAAArB,QAAKsB,UAAUC,UAAUC,OAAO,aAExCvB,EAAWwB,eAAiBZ,EACFZ,EAAfyB,cAAgBP,EAAKC,YACGnB,EAAxB0B,YAAcxB,EACKF,EAAnB2B,mBAEXP,EAAArB,QAAKsB,UAAUC,UAAUM,IAAI,cAE7B,EAAAC,EAAAC,gBAAeZ,EAAKa,UACpB,EAAAC,EAAAC,iCAAgCf,EAAKa,Q,2DAGzCG,QAAQC,IAAGC,EAAAC,I,0BAEZ,EAAAC,EAAAC,iB,4EAvBQpC,EAAcC,MAAAC,KAAAC,U,CAlB7Bc,EAAArB,QAAKyC,WAAWC,iBAAiB,UAEjC,SAAkBC,GAKd,GAHAA,EAAMC,iBACN9C,EAAW+C,WAAaF,EAAMG,cAAcC,SAASC,MAAMC,MAAMC,OAEtC,KAAvB7B,EAAArB,QAAKmD,QAAQF,MACZ,OAAO5B,EAAArB,QAAKsB,UAAUC,UAAUC,OAAO,aAG5CH,EAAArB,QAAKsB,UAAUC,UAAUM,IAAI,aAE7B1B,KACA,EAAAoC,EAAAa,iBACA/B,EAAArB,QAAKmD,QAAQF,MAAQ,E","sources":["src/js/search-by-keyword.js"],"sourcesContent":["import { renderFilmList } from \"./fetch-films-main.js\"\nimport { preloaderShow, preloaderShowLonger, hidePreloader } from './loader';\nimport { addCurrrentMoviesToLocalStorage } from \"./local-storage\";\nimport Pagination from './pagination.js';\nimport API from './api-service.js';\nimport refs from './refs';\n\nconst apiService = new API;\nconst pagination = new Pagination;\n\nrefs.searchForm.addEventListener('submit', onSearch);\n\nfunction onSearch(event) {\n    \n    event.preventDefault();\n    apiService.inputQuery = event.currentTarget.elements.query.value.trim();\n\n    if (refs.inputEl.value === \"\") {\n         return refs.errorText.classList.remove('is-hidden');\n    }\n    \n    refs.errorText.classList.add('is-hidden');\n   \n    getSearchMovie();\n    preloaderShow();\n    refs.inputEl.value = \"\";\n}\n\nasync function getSearchMovie(page = false) {\n    \n    const queryPage = page ? page : 1; // Проверка страниц, обязательно до fetch\n    apiService.setPageNumber = queryPage; // Передает текущую страницу в класс api\n\n    try {\n        await apiService.fetchSearchMovie().then(data => {\n          if (data.total_pages === 0) {\n             return refs.errorText.classList.remove('is-hidden');\n           };\n            pagination.setCurrentPage = queryPage; // Передает страницу в пагинатор\n            pagination.setTotalPages = data.total_pages; // Передает общее кол-во страниц в пагинатор\n            pagination.setCallback = getSearchMovie; // Передает ссылку на коллбэк функцию \n            pagination.renderPagination(); // Вызов пагинации\n            \n            refs.errorText.classList.add('is-hidden');\n            \n            renderFilmList(data.results);\n            addCurrrentMoviesToLocalStorage(data.results);\n        });      \n    } catch (error) {\n        console.log(error)\n    } finally {\n       hidePreloader();\n    }\n    \n}\n"],"names":["$bpxeT","parcelRequire","$ffc2dcc44f21eabb$var$apiService","$1h2Gi","default","$ffc2dcc44f21eabb$var$pagination","$jcFG7","$ffc2dcc44f21eabb$var$getSearchMovie","$ffc2dcc44f21eabb$var$_getSearchMovie","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","page","queryPage","_args","length","setPageNumber","fetchSearchMovie","then","data","total_pages","$4Nugj","errorText","classList","remove","setCurrentPage","setTotalPages","setCallback","renderPagination","add","$4y7rq","renderFilmList","results","$4LMMA","addCurrrentMoviesToLocalStorage","console","log","_ctx","t0","$kvC6y","hidePreloader","searchForm","addEventListener","event","preventDefault","inputQuery","currentTarget","elements","query","value","trim","inputEl","preloaderShow"],"version":3,"file":"index.5a370b96.js.map"}